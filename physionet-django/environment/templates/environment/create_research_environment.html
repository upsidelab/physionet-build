{% extends 'base.html' %}

{% load static %}

{% load project_templatetags %}

{% block title %}Create Research Environment{% endblock %}

{% block local_css %}
<link rel="stylesheet" type="text/css" href="{% static 'project/css/project-home.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'environment/css/create_research_environment.css' %}">
{% endblock %}

{% block content %}
<div class="container">
  {% include "message_snippet.html" %}
    <h1 class="mb-4">
      Create Research Environment
    </h1>
    <div class="card" style="width: 36rem;">
      <div class="card-body">
        <h3 class="card-title">
            Project: <span class="font-italic">{{ project.title }}</span>
        </h3>

        <form action="{% url 'create_research_environment' project_slug=project.slug project_version=project.version %}" method="post" style="width: 24rem;">
            {% csrf_token %}
            {{ form }}
            <button class="btn btn-primary mt-3" type="submit">
                Create environment
            </button>
        </form>
      </div>
    </div>
</div>
{% endblock %}

{% block local_js_bottom %}
<script>
  (function() {
    const jupyterTypeRadioButton = document.querySelector("#id_environment_type input[value='jupyter']");
    const rstudioTypeRadioButton = document.querySelector("#id_environment_type input[value='rstudio']");
    const persistentDiskInput = document.getElementById("id_persistent_disk");

    persistentDiskInput.disabled = !jupyterTypeRadioButton.checked;
    jupyterTypeRadioButton.addEventListener("change", function() {
      persistentDiskInput.disabled = false;
      persistentDiskInput.value = null;
    });
    rstudioTypeRadioButton.addEventListener("change", function() {
      persistentDiskInput.disabled = true;
      persistentDiskInput.value = 100;
    });
  })();
</script>
{% endblock %}