{% extends 'environment/base_environment_home.html' %}

{% block main_view %}
    <div class="card text-center" style="width: 30rem; margin: auto">
      <div class="card-body">
        <h5 class="card-title">Your workspace is being provisioned...</h5>
        <p class="card-text">It will take around 5 minutes.</p>
          <div class="loader">Loading...</div>
      </div>
    </div>
{% endblock %}

{% block local_js_bottom %}
<script>
    const csrfToken = getCookie("csrftoken");
    function checkWorkspaceStatus() {
        fetch("{% url "is_workspace_setup_done" %}",{
            method: 'GET',
            credentials: "same-origin",
            headers: {
                "X-CSRFToken": csrfToken,
                "Content-Type": "application/json",
            },
        })
        .then(response => response.json())
        .then(({ finished }) => finished && location.reload());
     }

    const thirty_seconds = 30000;
    setInterval(checkWorkspaceStatus, thirty_seconds);
</script>
{% endblock %}
